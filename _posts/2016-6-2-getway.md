---
layout: post
author: ttthzy
title:  "微服务API-Gateway设计思路"
permalink: /:categories/:title.html
date:   2016-06-02 10:30:00 +0800
categories: logs update
---


#### 考虑因素

* 通过微服务提供的API的粒度往往和客户端需要的不同。微服务通常提供细粒度的API，这意味着客户端需要与多个服务进行交互。

* 不同的客户端需要不同的数据。

* 网络性能因为不同类型的客户端而不同。

    例如，移动网络通常要慢得多，并具有高得多的延迟。当然，任何广域网是比一个局域网慢得多。这意味着手机本地客户端使用的网络与服务端web应用的LAN的性能特点区别很大。服务端web应用可以在不影响用户体验的情况下，向后端服务发送大量请求，但手机客户端只能发送少量的请求。

* 服务实例数量和它们的位置（主机+端口）动态改变。

* 服务可能随时间改变，所以要对客户端隐藏细节。

#### 解决方案

![](/images/4758-20151103101833102-68764928.jpg)

* 该API网关可以为每个客户端提供不同的API，而不是提供一个适合所有情况下的API。例如，Netflix的API网关运行客户端特定适配器代码，提供给每个客户端它们需要的API。

* API网关还可以实现安全性，例如： 验证客户端被授权执行请求。

#### 如何实现API网关？

API网关需要支持高并发、高负载，所以GO语言微线程方式是实现getway的最佳选择之一。

#### 结论

使用API​​网关具有以下优点：

1. 使服务和客户端解耦。

1. 使客户端和服务部署环境解耦。

1. 提供了最佳的API给每个客户端。

1. 减少的请求/往返次数。例如，API网关可以一次性检索多个服务的数据。更少的请求也意味着更少的开销，提高了用户体验。一个API网关对于移动应用至关重要。

1. 简化了客户端的调用，因为API网关可以组合服务，并提供组合后的façade接口。

API网关模式也有一些缺点：

1. 增加的复杂性，API网关是必须开发、部署和管理的另一个应用。

1. 增加的响应时间，因为通过API网关多了一层网络跳转。然而，对于大多数应用的额外往返的成本是微不足道的。


----------

本人博客文章采用CC [Attribution-NonCommercial](https://creativecommons.org/licenses/by-nc-sa/3.0/ "Attribution-NonCommercial")协议: CC Attribution-NonCommercial 必须保留原作者署名,并且不允许用于商业用途,其他行为都是允许的。

----------


[jekyll-docs]: http://jekyllrb.com/docs/home
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-talk]: https://talk.jekyllrb.com/
